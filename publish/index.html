
<!DOCTYPE HTML>
<html>
<head>
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>Christopher Agocs  | Agocs</title>

<meta name="author" content="Christopher Agocs"> 

<meta name="description" content="Sometimes I blog stuff"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Agocs" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Agocs</a></h1>
<h4>Christopher Agocs</h4>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/social-media">Contact + Social Media</a></li>
	<li><a href="/resume">Resume</a></li>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/archives">Archive</a></li>
	<li><a href="/robotfindskitten/non-kitten-item/">Robot Finds Kitten</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/social-media">Contact + Social Media</a></li>
	<li><a href="/resume">Resume</a></li>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/archives">Archive</a></li>
	<li><a href="/robotfindskitten/non-kitten-item/">Robot Finds Kitten</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:agocs.org">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/09/14/golang-philly-talk/">
		
			Golang Philly Talk</a>
	</h2>
	<div class="entry-content">
		<p>I gave a talk at Golang Philly last night! <a href="https://agocs.org/assets/Golang_Philly_Home_Automation.pdf">Here are some slides.</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-09-14T10:15:28-04:00" pubdate data-updated="true">Sep 14<span>th</span>, 2016</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/hack/'>hack</a>, <a class='category' href='/blog/categories/talks/'>talks,</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/02/16/ten-top-tips-to-keep-your-home-thorium-core-reactor-in-tip-top-shape/">
		
			Top Ten Home Thorium Core Reactor Tips</a>
	</h2>
	<div class="entry-content">
		<p><em>This is the first in what I hope may be a series of retrofuturistic pieces styled after 1950s era Popular Mechanics DIY home improvement articles. I hope it&rsquo;s fun to read!</em></p>

<p>More and more homeowners nowadays find themselves switching away from antiquated electricity sources like geothermal and municipal grid, and adopting a super-efficient Home Thorium Core Reactor instead. Known for their safety and low waste, these reactors will power a home for pennies a day. However, ask Thorium Core Reactor early adopters, and you&rsquo;ll hear many stories about their fickle nature.</p>

<p>The editorial team here at Popular Robotics has compiled a list of tips to keep your Home Thorium Core Reactor working like new. We hope you&rsquo;ll find them useful.</p>

<h2>1) Use High Quality Thorium</h2>

<p>It may be tempting to purchase your thorium at the local home improvement superstore, but impurities in your fuel will lead to nasty buildup on the primary heat exchanger coil. Your radioelectric efficiency (W/Sv, or watts per sievert) will drop, and you&rsquo;ll have to power down your reactor more frequently for maintenance. It&rsquo;s well worth the few extra dollars to find an independent isotope fuel distributor and purchase Grade 5 (that&rsquo;s 99.5% pure) or better thorium.</p>

<p>That said, if you have a bag of cheap thorium that you want to use, grind it finely and mix it 10 parts to 1 part charcoal ash and 2 parts deionized water. Let that sit overnight, then use a minimum of 10 parts DI water to rinse away the ash. The remaining thorium will be at least Grade 3.</p>

<h2>2) Clean Your Coils</h2>

<p>Even using high quality fuel, you&rsquo;ll want to keep your Home Thorium Core Reactor running at peak efficiency, right? The easiest way to do this is to power your unit down at least twice a year to clean buildup from your primary and secondary heat exchanger coils. Scouring with a paste made from baking soda will take care of most of it, but excess sulfur scaling may need to be dissolved away using a weak lye solution. Your coils don&rsquo;t need a bright finish, but they should appear clean and free of debris before going back in the reactor.</p>

<p>We like to plan our maintenance right around the Spring and Fall Equinoxes. You&rsquo;ll be without power for a few hours, so it&rsquo;s important to pick a nice time of year so your home doesn&rsquo;t get too hot or too cold.</p>

<h2>3) Capacity Planning</h2>

<p>Your Home Thorium Core Reactor may be rated at 24kW peak, but it will wear a lot more slowly running continuously at 25% max power than at 75%. If you&rsquo;re planning to convert to Home Thorium Core Reactor power, or if you&rsquo;re planning to replace an aging first generation unit, it may be better to size up rather than choosing the smallest unit that fits your needs.</p>

<p>Larger Home Thorium Core Reactors don&rsquo;t just last longer &mdash; they&rsquo;re more efficient too! Your bigger heat exchangers will collect buildup much more slowly, and beefier dingle arms will withstand more output changes.</p>

<h2>4) Keep Your Output Steady</h2>

<p>It may be tempting to buy a flash Home Thorium Core Reactor that can respond to demand spikes in seconds, but rapid output cycling goes hand in hand with rapid thermal cycling, which, of course, leads to premature manifold cracking. Replacing a damaged manifold can take a few days, during which your family will have to go without power or purchase expensive municipal power.</p>

<p>Instead, you may find it more economical to purchase a capacitor bank and place it in line with your power output. The bank will handle any sudden surges in demand, allowing your reactor to sedately adjust output.</p>

<h2>5) Check Your Dingle Arms</h2>

<p>The dingle arms move the control rods that moderate your Home Thorium Core Reactor&rsquo;s power output. Like all moving parts, they wear. A seized dingle arm can prevent your reactor from powering up, or, worse, prevent it from powering down. In the second case, you run the risk of a thermal runaway, and your reactor would SCRAM itself. That&rsquo;s a costly repair that can take several weeks, during which time you&rsquo;ll be left with little choice but to buy expensive municipal power.</p>

<p>When you take your reactor down for maintenance, inspect each dingle arm. Make sure they move freely, and check the bearing surfaces for excessive pitting or scoring.</p>

<h2>6) Keep Spare Dingle Arm Bushings On Hand</h2>

<p>If you find a worn dingle arm and you don&rsquo;t have spare bushings on hand, you&rsquo;ve got a few choices:</p>

<ul>
<li>Bring the reactor back on line, order a spare, and then take the reactor back off line when it comes in</li>
<li>Keep your reactor off line until the spare comes in</li>
<li>Bring your reactor back on line, order a spare, and hope nothing goes wrong until the next scheduled reactor maintenance</li>
</ul>


<p>None of these are very pleasant. If you had a handful of spare bushings sitting in your tool box, this would not be a concern.</p>

<h2>7) Use Rubber Bushings</h2>

<p>Fast output adjusting Home Thorium Core Reactors use expensive polyurethane bushings because they&rsquo;re firm and afford for very fast dingle arm adjustment. They also transmit a lot of harsh vibrations back into the control module. Some Home Thorium Core Reactors have oversized stepper motors to account for this, but yours might not.</p>

<p>If you&rsquo;ve followed our advice by overplanning for capacity and installing a capacitor bank, you don&rsquo;t need fast output adjustment. Use the rubber bushings. They&rsquo;re cheaper, they last longer, and they&rsquo;ll cause a lot less wear on your control module.</p>

<h2>8) Keep Your Cool</h2>

<p>Your Home Thorium Core Reactor works on the basic principle of moving energy from a hot area to a cool area. If the temperature around your unit gets too high, your radioelectric efficiency will drop. We&rsquo;ve seen drops as great as 50W/Sv in a 12kW unit mounted in direct sunlight in the middle of a South Florida summer.</p>

<p>The obvious place for a Home Thorium Core Reactor is in the basement, but basements just aren&rsquo;t common in some parts of the country. If that&rsquo;s not an option for you, we recommend the north side of your house (for those of you in the northern hemisphere, of course). That will keep your reactor in the shade during the heat of the summer day, and you&rsquo;ll see the returns in the form of less thorium fuel spent.</p>

<h2>9) Get Up To Code</h2>

<p>You&rsquo;ll want to make sure your home wiring is up to code when you install your Home Thorium Core Reactor. In most municipalities, you should have pulled a permit and had your installation inspected before the first power up, but we understand that doesn&rsquo;t always happen. Weak aluminum to copper connections can act like resistive loads, wasting power and consuming excess fuel, causing your reactor to run much harder than it would otherwise. Make sure your breaker box and breakers are up to at least the 2145 standard, because your home reactor is capable of delivering more power than the municipal grid, and you need the protection and heat dissipation offered by modern breakers.</p>

<h2>10) To Insulate or not To Insulate</h2>

<p>Surprisingly, given the low cost of Home Thorium Core Reactor generated power, it may not be worth upgrading your home insulation! For the average home, unless you&rsquo;re adding more than 20 R value points to the roof and walls, it&rsquo;s cheaper to simply heat and cool the space as necessary when amortized across the 20 year operational life that can be expected from a well-maintained reactor before it needs its first major overhaul. Additionally, if you live somewhere with very cold winters, we&rsquo;ve seen kits that pass water or glycol around your secondary heat exchanger windings and can be used to run a radiator system or pre-warm your forced air heating. You can expect to see around 2W/Sv efficiency decrease running a system like that in the winter, but you wind up spending less fuel overall heating your home.</p>

<h2>Conclusion</h2>

<p>Over the past decade, Home Thorium Core Reactor technology has proved itself an economical and reliable alternative to municipal power sources, and we expect to see adoption increase in the future. Whether you&rsquo;re on the fence about installing your first reactor, planning your next upgrade, or simply enjoying economical, clean energy, you can follow these simple steps to get years of reliable power generation.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-02-16T21:59:11-05:00" pubdate data-updated="true">Feb 16<span>th</span>, 2016</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/popularrobotics/'>PopularRobotics</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/01/10/jeepbox/">
		
			Jeep Box</a>
	</h2>
	<div class="entry-content">
		<p>One of the problems with Jeep Wrangler ownership is there&rsquo;s nowhere to store things out of sight. Your backpack, laptop, whatever, it&rsquo;s all hangin&#8217; out there in the open. Even when you&rsquo;ve zipped the top up, there&rsquo;s nothing between your valuables and a set of sticky fingers besides a thin sheet of clear vinyl.</p>

<p>I wanted to feel better about leaving things in the Jeep, and I wanted to design something sturdy so that I could still carry heavy things in the back of the Jeep. I also wanted to cut down on the general clutter in my cargo area, and I wanted to practice welding.</p>

<p>I imagined something like this:</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-WhDR5Qd/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-WhDR5Qd/0/L/IMG_20151213_233221-L.jpg" alt=""></a></p>

<p>So I started with some rough measurements.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-pRWHkrf/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-pRWHkrf/0/XL/IMG_20160110_164946-XL.jpg" alt=""></a></p>

<p>That&rsquo;s a top view and rear view of the back of the Jeep. I had 34.5&#8221; between the brackets where the rear seat would have mounted if I had one, 35&#8221; of length to work with, and 15.5&#8221; between the bottom of the opening and the bottom of the rear window.</p>

<p>So, to summarize, what I wanted was a drawer and a frame to hold that drawer that fit in the above-defined envelope. The frame would have to be reasonably sturdy, because I&rsquo;d like to put things on top of it too. I&rsquo;m the kind of person who thinks really well in design tools, so I fired up Autodesk and got to work.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-BkMSCKq/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-BkMSCKq/0/M/jeepbox0-M.png" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-f9XHK5m/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-f9XHK5m/0/M/jeepbox-M.png" alt=""></a></p>

<p>This was the first pass, and some measurements. I ran it by some Internet folks, and they suggested diagonal bracing.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-C39GHxD/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-C39GHxD/0/M/jeepbox1-M.png" alt=""></a></p>

<p>My plan was to attach a sheet of plywood to the top using T-nuts and cap screws, and to put roller bearings on the horizontal bars running along the sides to act as drawer slides. The T-nuts and cap screws were entirely reasonably priced through McMaster-Carr, but the roller bearings were about $5 ea. I found equivalent skate bearings on Amazon for about $1 ea.</p>

<p>Using the CAD drawings, I figured out what pieces I&rsquo;d need.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-bkW8ccS/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-bkW8ccS/0/L/IMG_20160110_165039-L.jpg" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-KpPPZbL/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-KpPPZbL/0/L/IMG_20160110_165045-L.jpg" alt=""></a></p>

<p>I did some math, and figured I could fit that into 19 pieces of 37&#8221; x &frac12;&#8221; square stock (N.B. I was wrong, and probably should have ordered 20 or 21 pieces). From Metals Supermarket, that was just over $50.</p>

<p>I got to welding.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-hZ3gTBj/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-hZ3gTBj/0/L/20151122202228-L.jpg" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-3THvt8F/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-3THvt8F/0/L/20151127145653-L.jpg" alt=""></a></p>

<p>Then I realized, I&rsquo;d have to mount this in the Jeep! I&rsquo;d figured I&rsquo;d use the rear seat belt mounting bolt, but I forgot to locate that with my previous measurements. I rectified that.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-vdQh37C/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-vdQh37C/0/L/IMG_20160110_165102-L.jpg" alt=""></a></p>

<p>I bought a sheet of flat steel stock, milled in a hole for the seat belt bolt, and welded that into place. A test-fit revealed that I&rsquo;d milled the hole in the wrong place, so I had to fix that, first with the angle grinder, then with a plasma cutter.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-vJ7hXHd/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-vJ7hXHd/0/L/IMG_20151213_161552-L.jpg" alt=""></a></p>

<p>Finally, it went to paint! I wanted to powder coat it, but I got a $150 quote for powder coating. A little rich for my blood. I used a can and a half of Rustoleum black enamel instead.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-CZvPjPL/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-CZvPjPL/0/L/IMG_20151213_161533-L.jpg" alt=""></a></p>

<p>While that was curing, I designed the wooden top and drawer.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-M5HxzpL/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-M5HxzpL/0/L/IMG_20160110_165118-L.jpg" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-fzJvNqc/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-fzJvNqc/0/L/IMG_20160110_165126-L.jpg" alt=""></a></p>

<p>I decided to make it all out of &frac12;&#8221; plywood, cut from &frac12; sheets of plywood (because half sheets are easier to move than full sheets). The drawer, I figured I&rsquo;d just use brads and glue to hold it together. If it fell apart, I could always re-do it.</p>

<p>Because the wooden pieces were just rectangles, I let the robots take care of cutting them out.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-kXbHbZJ/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-kXbHbZJ/0/L/IMG_20151213_190147-L.jpg" alt=""></a></p>

<p>The next night, I loaded up all the pieces and started attaching them together.</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-9MDj4c5/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-9MDj4c5/0/L/IMG_20151215_214357-L.jpg" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-VKZjkqQ/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-VKZjkqQ/0/L/IMG_20151215_214523-L.jpg" alt=""></a></p>

<p>The skate bearings I bought had an inner diameter that was just a little bigger than the screws I used, so I turned the screws into cones on the lathe to locate the bearings better (not pictured, but I wish I had).</p>

<p>Everything in the Jeep so far:</p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-FbtLRtD/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-FbtLRtD/0/L/IMG_20151215_220627-L.jpg" alt=""></a></p>

<p><a href="https://agocs.smugmug.com/Other/Jeepquest/i-cNtzdDR/A"><img src="https://agocs.smugmug.com/Other/Jeepquest/i-cNtzdDR/0/L/IMG_20151215_220644-L.jpg" alt=""></a></p>

<p>It&rsquo;s been about a month since I finished all that, and I have the drawer together and installed; I just haven&rsquo;t taken pictures of it yet. It served us well on our trip to Georgia &mdash; our valuables went into the drawer, and my wife&rsquo;s big suitcase got strapped to the top.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-01-10T17:19:55-05:00" pubdate data-updated="true">Jan 10<span>th</span>, 2016</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/hack/'>hack</a>, <a class='category' href='/blog/categories/jeep/'>jeep</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/11/12/how-i-clean-my-boots/">
		
			How I Clean My Boots</a>
	</h2>
	<div class="entry-content">
		<p>I own a pair of Redwing leather boots. I really like these boots. They&rsquo;re formal enough to be worn with dress clothes, but sturdy enough that I can grub around fixing cars and installing drywall. Good boots take care, especially to keep them waterproof and looking clean. This is what I&rsquo;ve been doing.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-tzM95Xg/A"><img src="https://agocs.smugmug.com/Other/Boots/i-tzM95Xg/0/L/20151112132901-XL.jpg" alt=""></a></p>

<p>I start with some dirty boots. Look at that dirt!</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-jjzVkjC/A"><img src="https://agocs.smugmug.com/Other/Boots/i-jjzVkjC/0/XL/20151112132910-XL.jpg" alt=""></a></p>

<p>We gotta get rid of all that dirt. I use an old microfiber towel. I normally wipe the dirt off every few days, but for a deep clean I&rsquo;ll remove the laces and really go at it.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-xLvtPHD/A"><img src="https://agocs.smugmug.com/Other/Boots/i-xLvtPHD/0/XL/20151112133247-XL.jpg" alt=""></a></p>

<p>It looks okay, but you can see the dust stuck in some of the natural wrinkles of the leather, as well as the boot&rsquo;s seams. To get that, I go at it with a stiff plastic brush.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-FF6vpn6/A"><img src="https://agocs.smugmug.com/Other/Boots/i-FF6vpn6/0/XL/20151112133545-XL.jpg" alt=""></a></p>

<p>I brush against the grain, sometimes stretching the boots to get into the wrinkles. I also brush inside all the seams, and around the base of the upper.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-dJLzTpg/A"><img src="https://agocs.smugmug.com/Other/Boots/i-dJLzTpg/0/XL/20151112134907-XL.jpg" alt=""></a></p>

<p>I follow up with Saddle Soap and a toothbrush. I put a sliver of saddle soap into an old coffee mug that&rsquo;s &frac14; full of hot water, stir that up well, and go to town. I get all the seams, re-touch all the wrinkles, and really scrub wherever I&rsquo;ve scuffed the leather. The saddle soap contains glycerin (so I&rsquo;m told) that helps to protect the leather. I scrub one shoe, then the other, then I rub them both dry with the same microfiber towel.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-znGdxFH/A"><img src="https://agocs.smugmug.com/Other/Boots/i-znGdxFH/0/XL/20151112140024-XL.jpg" alt=""></a></p>

<p>Dried on the left, still wet on the right. We&rsquo;re already doing pretty well, but we could do better.</p>

<p>I pre-heat the oven to 170 degrees (the lowest it will go), remove the top rack, and put aluminum foil on the bottom rack. I stick the shoes in the oven for 20 minutes or so. This dries the shoes out, gets them nice and warm, and opens up the pores in the leather. Then I rub the shoes with mink oil.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-Pnt7Knd/A"><img src="https://agocs.smugmug.com/Other/Boots/i-Pnt7Knd/0/XL/20151112143913-XL.jpg" alt=""></a></p>

<p>The mink oil makes the leather more supple, it hides scratches and scuffs, and it adds water resistance. I smear it on heavily, especially the scuffed areas on the toes. Those areas seem to drink up mink oil, so I add more and more until they stop.</p>

<p>The shoes go back in the oven for another few minutes to let the mink oil really soak in, then I pull them out and turn the oven off. I take a clean rag (or old tee shirt, or old sock) and buff the shoes to a medium luster.</p>

<p><a href="https://agocs.smugmug.com/Other/Boots/i-S8CFvkD/A"><img src="https://agocs.smugmug.com/Other/Boots/i-S8CFvkD/0/XL/20151112145809-XL.jpg" alt=""></a></p>

<p>Shoe polish? I don&rsquo;t use it on these shoes. I like the look of the natural leather, and I&rsquo;m going to keep caring for these boots in this way as they wear in.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-11-12T20:17:33-05:00" pubdate data-updated="true">Nov 12<span>th</span>, 2015</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/shoes/'>shoes</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/10/10/assigning-globals-in-go/">
		
			Assigning Globals in Go</a>
	</h2>
	<div class="entry-content">
		<p>This has bitten me in the butt a few times this week, so I figured I&rsquo;d blog about it.</p>

<h3>Be careful with your scope when you&rsquo;re assigning values to global variables in Go!</h3>

<p>Here&rsquo;s a quick little example. We have a globally scoped variable, <code>foo</code>. In our <code>main()</code>, we call <code>makeSomething()</code>, which returns to us, we hope, a <code>something</code> and a <code>nil</code> error. Then we make that global <code>foo</code> variable point to that variable.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="kt">int</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">anInt</span><span class="p">()(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">){</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">7</span><span class="p">,</span> <span class="kc">nil</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
</span><span class='line'>  <span class="nx">foo</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">anInt</span><span class="p">()</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">print</span> <span class="p">(</span><span class="s">&quot;Oh god!&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nb">println</span><span class="p">(</span><span class="s">&quot;foo was assigned the value of&quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">printFoo</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">printFoo</span><span class="p">(){</span>
</span><span class='line'>  <span class="nb">println</span><span class="p">(</span><span class="s">&quot;I see foo as&quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Easy peasy, right? Nope.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="err">$</span> <span class="k">go</span> <span class="nx">run</span> <span class="nx">stuff</span><span class="p">.</span><span class="k">go</span>
</span><span class='line'><span class="nx">foo</span> <span class="nx">was</span> <span class="nx">assigned</span> <span class="nx">the</span> <span class="nx">value</span> <span class="nx">of</span> <span class="mi">7</span>
</span><span class='line'><span class="nx">I</span> <span class="nx">see</span> <span class="nx">foo</span> <span class="nx">as</span> <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>What we&rsquo;ve done is created a <strong>locally scoped</strong> variable <code>foo</code> that disappears once we exit <code>main()</code>! That&rsquo;s because <code>:=</code> is a short-form variable declaration and assignment. The compiler believes we are declaring a variable <code>foo</code> and assigning it the value returned by <code>anInt()</code>.</p>

<p>Let&rsquo;s run through a few possible variations:</p>

<h3>foo alreay exists</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">foo</span> <span class="o">:=</span> <span class="mi">3</span>
</span><span class='line'>        <span class="nx">foo</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">anInt</span><span class="p">()</span>          <span class="c1">// Weirdly, no error here</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>                  <span class="c1">// Local foo is delcared,</span>
</span><span class='line'>                <span class="nx">print</span> <span class="p">(</span><span class="s">&quot;Oh god!&quot;</span><span class="p">)</span>      <span class="c1">// assigned 3, then assigned 7.</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nb">println</span><span class="p">(</span><span class="s">&quot;foo was assigned the value of &quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">printFoo</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Just assign</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">foo</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">anInt</span><span class="p">()</span>           <span class="c1">// Compiler error!</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>              <span class="c1">// undefined: err</span>
</span><span class='line'>                <span class="nx">print</span> <span class="p">(</span><span class="s">&quot;Oh god!&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nb">println</span><span class="p">(</span><span class="s">&quot;foo was assigned the value of&quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">printFoo</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Use a temporary variable</h3>

<p>Of course, if we do this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">anInt</span><span class="p">()</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">print</span> <span class="p">(</span><span class="s">&quot;Oh god!&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>  <span class="nx">foo</span> <span class="p">=</span> <span class="nx">f</span>
</span><span class='line'>        <span class="nb">println</span><span class="p">(</span><span class="s">&quot;foo was assigned the value of&quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">printFoo</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>we see:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="err">$</span> <span class="k">go</span> <span class="nx">run</span> <span class="nx">stuff</span><span class="p">.</span><span class="k">go</span>
</span><span class='line'><span class="nx">foo</span> <span class="nx">was</span> <span class="nx">assigned</span> <span class="nx">the</span> <span class="nx">value</span> <span class="nx">of</span>  <span class="mi">7</span>
</span><span class='line'><span class="nx">I</span> <span class="nx">see</span> <span class="nx">foo</span> <span class="nx">as</span> <span class="mi">7</span>
</span></code></pre></td></tr></table></div></figure>


<p>&hellip;which is what we&rsquo;d expect. However, that&rsquo;s a little fugly. Let&rsquo;s tidy that up a bit.</p>

<h3>Pre-declare your error</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">(){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">err</span> <span class="kt">error</span>
</span><span class='line'>        <span class="nx">foo</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">anInt</span><span class="p">()</span>
</span><span class='line'>        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">print</span> <span class="p">(</span><span class="s">&quot;Oh god!&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nb">println</span><span class="p">(</span><span class="s">&quot;foo was assigned the value of &quot;</span><span class="p">,</span> <span class="nx">foo</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">printFoo</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Declare an <code>error</code> called <code>err</code>, do the assignment, and then go on with your day.</p>

<p>Anyway, lesson learned. When you&rsquo;re dealing with globally scoped variables and multiple return values and something doesn&rsquo;t behave the way you think it should, make sure you&rsquo;re using the variable you think you&rsquo;re using.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-10-10T01:47:48-04:00" pubdate data-updated="true">Oct 10<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/08/20/introducing-uluru/">
		
			Introducing Uluru</a>
	</h2>
	<div class="entry-content">
		<p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Uluru_Panorama.jpg" /></p>

<p>I don&rsquo;t work for <a href="https://www.backstopsolutions.com/careers">Backstop</a> any more (but you should), but back when I did, we discovered we had no idea how long it took our users to load our tools. Hell, we couldn&rsquo;t even figure out how many clicks per month we had! I was working with New Relic trying to get a quote from them, and the best I could do was 2 million plus or minus 800 thousand. We had insight into how long it took our servers to respond to requests, but no thought was given to DNS, loading outside resources, rendering DOM, etc.</p>

<p>We tried New Relic Browser, but that failed for two reasons. First, something in the few-hundred-kilobytes of minified JavaScript was conflicting with something in our JavaScript in a way that broke automated testing. Second, on a sales call, we determined that Browser really wasn&rsquo;t going to tell us the information we wanted to know. It&rsquo;s a good tool, for sure, but it didn&rsquo;t expose the depth of data we wanted.</p>

<p><a href="https://twitter.com/alarmingcow">Colin</a> found a tool called <a href="https://github.com/yahoo/boomerang">Yahoo Boomerang</a> which seemed to do what we needed. It would collect metrics on how long it took the page, and various resources on the page, to load, and it would report those data back to a server over here. Simple, right?</p>

<p>I took two issues with Boomerang. First, it again broke our testing. Second, it used some ridiculous scheme of a GET request with URL parameters inside of an invisible iframe to get data back to the server without any cross-site request issues. This seemed entirely too complicated, and simplicity was one of my overarching goals. I decided to roll my own.</p>

<p>I was sitting in the audience at <a href="http://monitorama.com/">Monitorama</a>, and one of the speakers mentioned logging how long clients spent loading pages. I asked him about it, and he mentioned something in Vanilla JavaScript that allowed for that. I did some research, found out about <code>window.performance.Timing</code>, and thus Uluru was born.</p>

<p>The name, incidentally, came from back when I was experimenting with Boomerang. I needed a server to throw Boomerang data at, so I picked the famous Australian sandstone formation Uluru.</p>

<h2>Design goals</h2>

<p>There exist other solutions, commercial and open source, for recording and reporting on browser telemetry. It was found, however, that these solutions were significantly complex, and in many cases interfered with JavaScript we were already using, causing JavaScript errors and preventing the browser from rendering UI elements. Therefore, the design goals of Uluru became:</p>

<ul>
<li>Minimalism: Uluru.js is 47 lines of whitespace-heavy JavaScript. It should be extremely readable.</li>
<li>Light weight: When minified, Uluru.js squishes down under 500 bytes.</li>
<li>Speed: Uluru.js has no dependencies on other JS libraries.</li>
<li>No hacks: Uluru.js makes a single POST request to a remote server. It does not e.g. cram metrics into query parameters and make a series of requests GETting hidden images or iframes.</li>
</ul>


<h2>Implementation</h2>

<h3>Client side</h3>

<p>Uluru is a function that, when called, gets the time since navigation started and some other metrics, and sends those to an endpoint. We&rsquo;ve set it up such that <code>uluru(endpoint)</code> is called when <code>window.onload</code> fires, under the assumption that most of our product is useful by that point.</p>

<p>Uluru collects the following data:</p>

<ul>
<li>url: the <code>window.location.href</code></li>
<li>connectionTime: the time (ms since UNIX epoch) the connection was initiated.</li>
<li>connectionDelta: the time spent establishing a connection to the server</li>
<li>firstByte: the time spent waiting for the server to respond with the first byte of data</li>
<li>responseDelta: the time the server spent sending a response to the client</li>
<li>loadTime: time between the <code>navigationStart</code> and <code>window.onload</code> events.</li>
</ul>


<p>It also calls <code>window.performance.getEntries()</code> to provide specific timing on every resource (script, image, stylesheet, etc.) included in the page load.</p>

<h3>Server side</h3>

<p>Uluru rolls all the data it collects up into one PUT request. The easiest way to collect Uluru data is to include a data collection REST endpoint in your existent web application (or, if you&rsquo;re feeling clever, make your web proxy route Uluru requests to a specific Uluru logging server.</p>

<p>Alternatively, you could set the <code>Access-Control-Allow-Origin</code> header to allow the browser to make POST requests to a separate server you&rsquo;ve spun up for this purpose.</p>

<p>Either way, what we&rsquo;ve wound up doing is writing the Uluru data out to Splunk, and aggregating it there in interesting ways.</p>

<h2>Data</h2>

<p>Here&rsquo;s some of the data we were able to collect!</p>

<h3>Page loads and Appdexes</h3>

<p><a href="https://agocs.smugmug.com/Other/Misc/i-6PnMZv4/A"><img src="https://agocs.smugmug.com/Other/Misc/i-6PnMZv4/0/M/Screen%20Shot%202015-09-04%20at%201.57.31%20PM-M.png" alt="Photo &amp; Video Sharing by SmugMug"></a></p>

<p>One neat thing we didn&rsquo;t have before is an easy way to count how many page loads our system saw, how many unique users we had actively using our system, or how many clients were logged in on a given day. When you start making changes to system performance, you start thinking about things differently when you consider the 1ms wait you just removed will be multiplied by 73,000 over the course of a day.</p>

<p>Appdex is an interesting measure of system speed. You select a goal speed (2 seconds on the left, 4 seconds on the right), and you count page loads. Every page load that took under the goal speed counts for 1. Every load that took greater than the goal speed but under twice the goal speed counts for .5, and the rest count for 0. You divide the counted page loads by the total page loads, and you get a number between 0 and 1 that gives you a decent metric for how happy or sad your users are.</p>

<p>One really interesting thing we saw from this, we found by looking at individual clients. One of our clients had a significantly lower Appdex than the rest. We did some digging, and found that a condition in their data made every JSP load a huge number of records from the database to generate a list they never used. We disabled that for them, and they got much happier without ever realizing they were sad!</p>

<h3>Speed breakdown</h3>

<p><a href="https://agocs.smugmug.com/Other/Misc/i-trpgpLZ/A"><img src="https://agocs.smugmug.com/Other/Misc/i-trpgpLZ/0/M/Screen%20Shot%202015-09-04%20at%201.58.09%20PM-M.png" alt="Photo &amp; Video Sharing by SmugMug"></a></p>

<p>This is a bit more boring, but it lets us know how many page loads are fast, acceptable, slow, or super slow. Comparing, e.g., last hour with last 7 days lets us see any system wide problems before our clients call in.</p>

<h3>Page load histograms</h3>

<p><a href="https://agocs.smugmug.com/Other/Misc/i-sh6FZWC/A"><img src="https://agocs.smugmug.com/Other/Misc/i-sh6FZWC/0/M/Screen%20Shot%202015-09-04%20at%201.59.35%20PM-M.png" alt="Photo &amp; Video Sharing by SmugMug"></a></p>

<p>These let us know at a glance how our page loads are distributed. We could, for example, notice a bi-modal distribution. It wouldn&rsquo;t affect our average or median scores, but it would be indicative of something fishy.</p>

<p>I once noticed a particular user sending back negative page load speeds. I investigated it for a little bit and decided it was just one of those weird things that happen when you rely on multiple sources of time.</p>

<h3>Slow pages</h3>

<p><a href="https://agocs.smugmug.com/Other/Misc/i-X5dKdQs/A"><img src="https://agocs.smugmug.com/Other/Misc/i-X5dKdQs/0/M/Screen%20Shot%202015-09-04%20at%201.59.45%20PM-M.png" alt="Photo &amp; Video Sharing by SmugMug"></a></p>

<p>This report gives us some neat insight into what&rsquo;s been taking a long time to load. You look at each one, make sure it makes sense, and then use this graph to help prioritize your projects.</p>

<h3>Time sinks</h3>

<p><a href="https://agocs.smugmug.com/Other/Misc/i-RJRsk3M/A"><img src="https://agocs.smugmug.com/Other/Misc/i-RJRsk3M/0/M/Screen%20Shot%202015-09-04%20at%201.59.53%20PM-M.png" alt="Photo &amp; Video Sharing by SmugMug"></a></p>

<p>Likewise, just counting the total amount of time sunk into a resource is helpful. You might (much like we do) have a page that clients hit all the time. It might load in under two seconds, but if you can shave 10 % off of that, you&rsquo;re saving 20 hours per week aggregated across all of your users.</p>

<p>You can get a lot of really interesting data from visualizations like this. Use these to help justify speed projects.</p>

<h2>Further directions</h2>

<p>Currently, the Uluru project includes some stub code for a generic REST endpoint. I want to flush this out into something that writes logs for splunkd or logstash, or forwards data to services like Sensu or Riemann.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-08-20T16:46:16-04:00" pubdate data-updated="true">Aug 20<span>th</span>, 2015</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/hack/'>hack,</a>, <a class='category' href='/blog/categories/programming/'>programming</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/07/30/internet-jukebox/">
		
			Internet Jukebox</a>
	</h2>
	<div class="entry-content">
		<p>One of the hackerspaces at which I am a member installed a Beaglebone Black on their door and put a speaker outside.</p>

<p><a href="http://imgur.com/v3esU7N"><img src="http://i.imgur.com/v3esU7Nl.jpg" title="source: imgur.com" /></a><a href="http://imgur.com/Pyb5A9A"><img src="http://i.imgur.com/Pyb5A9Al.jpg" title="source: imgur.com" /></a></p>

<p>Now we can play sounds to the street, but to do so, you have to ssh into the Beaglebone. That&rsquo;s not bad, but it&rsquo;s a hassle. Okay, so can I make a REST endpoint that plays music?</p>

<p>(The answer is yes.)</p>

<p>Here&rsquo;s the <a href="https://github.com/agocs/bbb_sound_server">repo</a>. Let&rsquo;s go through it.</p>

<h2>Structure</h2>

<p>There are two endpoints, <code>/</code> and <code>/play/</code>. <code>/</code> returns a simple HTML form that lets the user upload a sound file. When the user clicks <code>Submit</code>, a <code>POST</code> request is made to <code>/play/</code>. The sound file is extracted from the form data, and asynchronously processed.</p>

<p>The sound file process is thus: it is saved to a temporary file on disk, <code>mplayer</code> is called on that file, and then when that process terminates, the sound file is removed.</p>

<h3>Serving a static html page</h3>

<p>is easy.</p>

<pre><code>controlfs := http.FileServer(http.Dir("control"))
http.Handle("/", controlfs)
</code></pre>

<p>There&rsquo;s a directory called <code>control</code>, and it contains <code>index.html</code>. When you hit <code>/</code>, you get index.html. Wildly easy.</p>

<h3>Creating that REST endpoint</h3>

<pre><code>http.HandleFunc("/play/", func(w http.ResponseWriter, req *http.Request) {
    if req.Method == "POST" {

        if req.ContentLength &gt; 10485760 {
            w.WriteHeader(http.StatusBadRequest)
            w.Write([]byte("File size capped at 10mb"))
            return
        }

        soundFile, headers, err := req.FormFile("soundFile")
        if err != nil {
            log.Printf("Error getting soundFile from Form. \n %s", err.Error())
            w.WriteHeader(http.StatusServiceUnavailable)
            return
        }
        log.Printf("Recieved %s", headers.Filename)
        w.Write([]byte("All done!"))
        go playASound(soundFile)

    } else {
        w.WriteHeader(http.StatusMethodNotAllowed)

        //TODO(cagocs): maybe return 200 with the name of the sound playing?
    }
})
</code></pre>

<p>Briefly, here&rsquo;s what we&rsquo;re doing:</p>

<ul>
<li>Setting up a url pattern, <code>/play</code>/.</li>
<li>Defining an anonymous function that runs when you hit <code>/play</code>/</li>
<li>Checking the request method.

<ul>
<li>if it&rsquo;s <code>POST</code>

<ul>
<li>Check the content-length. If it&rsquo;s greater than 10 MiB, return a status code 400.</li>
<li>Get the <code>soundFile</code> out of the form.</li>
<li>Log the filename</li>
<li>Return a status code 200</li>
<li>Asynchronously play the file</li>
</ul>
</li>
<li>if it isn&rsquo;t

<ul>
<li>Return a status code 405</li>
<li>I considered returning a string representation of all the files playing, but didn&rsquo;t.</li>
</ul>
</li>
</ul>
</li>
</ul>


<p><em>One quick point:</em> Yes, it&rsquo;s possible to spoof the content-length in a request. I didn&rsquo;t check for that. If you decide to run this in any sort of mission critical sense, maybe watch out for that.</p>

<h3>Playing a sound</h3>

<p>func playASound(file multipart.File) {</p>

<pre><code>    soundFile, err0 := ioutil.TempFile("", "sound_")
    if err0 != nil {
        log.Printf("Error initializing new file")
    }

    buffer, err1 := ioutil.ReadAll(file)
    if err1 != nil {
        log.Printf("Error reading mime multipart file")
    }

    err2 := ioutil.WriteFile(soundFile.Name(), buffer, os.ModeTemporary)
    if err2 != nil {
        log.Printf("Error writing file to disk")
    }

    cmd := exec.Command("mplayer", soundFile.Name())

    err3 := cmd.Run()
    if err3 != nil {
        log.Printf("Error playing file %s", soundFile.Name())
    }

    soundFile.Close()
    err4 := os.Remove(soundFile.Name())
    if err4 != nil {
        log.Println("Error deleting %s", soundFile.Name())
    }

}
</code></pre>

<p>So now we have a sound file in memory. How do we get it to the speakers? I spent a long time screwing around trying to figure out a &ldquo;pure Go&rdquo; solution, gave up, and decided to cheat. The Beaglebone Black will probably ship with <a href="https://en.wikipedia.org/wiki/MPlayer">MPlayer</a>; why not use that?</p>

<p>I skimmed through some code examples and came up with the solution above. <code>playASound</code> is running asynchronously, so it can spend some time doing what it needs to do. It creates a new <code>TempFile</code>, and writes the sound file there. It then creates a <code>Command</code> that calls <code>mplayer</code> and passes the name of the temporary file to <code>mplayer</code> as an argument. <code>Mplayer</code> plays the file, and when the <code>mplayer</code> process completes, our goroutine closes and removes the temporary file.</p>

<h2>Running</h2>

<p>I decided to not take my own advice and open this up to the general internet a few days ago. I used port forwarding on my router to forward :3030 on my external IP address to port :3030 on my laptop, and ran the program. I posted about it on IRC, forums, and made an Imgur post, and I got a few people participating.</p>

<p>I found it to be incredibly stable. No crashing, no issues running 4 to 6 instances of mplayer on top of one another. I was pleased with how the server handled unexpected EOFs and connection timeouts. Lastly, I discovered that letting people assault my ears with a barrage of mp3s is fun!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-30T11:40:50-04:00" pubdate data-updated="true">Jul 30<span>th</span>, 2015</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/hacking/'>hacking</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/03/01/sun-visor-bracket/">
		
			Sun Visor Bracket</a>
	</h2>
	<div class="entry-content">
		<p>I shattered the sun visor bracket on my Jeep in the cold this winter, so I did the only sensible thing. I tried to machine a new one.</p>

<p>I started with a block of 2&#8221; by 4&#8221; aluminum stock. I cut 2&#8221; off of it with a band saw. The blade popped off of its guide with about 1/10&#8221; left to go, so fixing that was a fun diversion.</p>

<p>I finally got a piece mounted in the Bridgeport and milled a few reference surfaces. I sent this picture to my friend to ask about the finish on that side milling. He said it was normal, if a little fugly.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-P5TTwjH/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-P5TTwjH/0/L/20150301140926-L.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p>I call this picture, &ldquo;Where the hell did I put my calipers?&rdquo;</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-TwhTxdW/A" title=""><img src="http://agocs.smugmug.com/Other/Jeepquest/i-TwhTxdW/0/L/20150301_143828-L.jpg" title="" alt=""></a></p>

<p>This is one of my favorite parts of machining. On the left, you can see the rough cut that&rsquo;s out-of-square. On the right, the machined surface.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-wrpwHTL/A" title=""><img src="http://agocs.smugmug.com/Other/Jeepquest/i-wrpwHTL/0/L/20150301_144604-L.jpg" title="" alt=""></a></p>

<p>I took a bunch more cuts, and got here.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-x8gJt6Q/A" title=""><img src="http://agocs.smugmug.com/Other/Jeepquest/i-x8gJt6Q/0/L/20150301_162907-L.jpg" title="" alt=""></a></p>

<p>Then I messed up.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-Btb5N32/A" title=""><img src="http://agocs.smugmug.com/Other/Jeepquest/i-Btb5N32/0/L/20150301_215830-L.jpg" title="" alt=""></a></p>

<p>Notice the middle part? That would be perfect, if the sun visor stuck up. Of course, it hangs down, so this part is completely worthless. Fortunately, I have enough stock to make a second one.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-03-01T23:28:19-05:00" pubdate data-updated="true">Mar 1<span>st</span>, 2015</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/hack/'>hack</a>, <a class='category' href='/blog/categories/jeep/'>jeep,</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/12/09/message-queues-and-go/">
		
			Message Queues and Go</a>
	</h2>
	<div class="entry-content">
		<p>I gave a talk last night to the ChicaGoLang meetup entitled &ldquo;Message Queues and Go.&rdquo; It went over using a Message Queue Broker as a backbone to tie together a service oriented archetecture, with examples in Go.</p>

<p>I put my slides here:</p>

<p><a href="http://go-talks.appspot.com/github.com/agocs/golangRabbitMQ/rmq.slide#1">http://go-talks.appspot.com/github.com/agocs/golangRabbitMQ/rmq.slide#1</a></p>

<p>and you can follow along with the video here:</p>

<iframe width="854" height="510" src="//www.youtube.com/embed/-S0-qgl8120?list=UUoGyPn-NIuAgkhlN7NAMhqw" frameborder="0" allowfullscreen></iframe>


<p>The examples in the code will, unfortunately, not work because they rely on RabbitMQ running on a specific IP address / port.</p>

<p>Let me know if there&rsquo;s anything I got wrong or missed!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-09T09:50:50-05:00" pubdate data-updated="true">Dec 9<span>th</span>, 2014</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/golang/'>golang</a>, <a class='category' href='/blog/categories/rabbitmq/'>rabbitmq</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/11/29/jeep-quest-part-4/">
		
			Jeep Quest Part 4</a>
	</h2>
	<div class="entry-content">
		<p>Jeepquest is at an end!</p>

<p>Thank you all so much for bearing with my inconsistently numbered posts.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-2kq7TjG/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-2kq7TjG/0/L/20141129_133006-L.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p>Today, Sabrina and I drove up to Kenosha, WI to take a look at this 2002 Wrangler X. First, we had breakfast at a place called The Coffee Pot, where the only not-so-great thing was their coffee. Afterwards, we went to Dan Stipler&rsquo;s Auto World.</p>

<p>This Wrangler looks almost bone stock. It has an aftermarket headunit and no rear seats, but beyond that, it&rsquo;s amazingly clean. What&rsquo;s better: no rust! According to the paperwork, this Jeep is from Arizona. The frame and suspension are utterly pristine.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-BMb8gf4/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-BMb8gf4/0/M/20141129_133037-M.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p> The salesman admitted he couldn&rsquo;t drive stick, so he asked me to pull it around. As cold as it&rsquo;s been, the Jeep needed a jump. It started right up once we did that, and Sabrina and I went for a test drive. We remarked on how smooth the engine felt relative to the other Jeep we&rsquo;d test driven together, how smooth the ride was once we got to the nicer roads, and how well it pulled.</p>

<p>The fuel light was on and we&rsquo;d been test driving for almost 20 minutes, so we stopped at a gas station to throw $5 worth of fuel in it. I got back in the Jeep to get back home, and it wouldn&rsquo;t start! I noticed a Toyota Landcruiser with bull bars and Star Wars vinyl decals on it, and I asked them if they&rsquo;d give me a jump. We get to talking, and they&rsquo;ve driven up from Florida. Sabrina and them talked about Tampa for a minute, then we got the Jeep started.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-2LtX85D/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-2LtX85D/0/M/20141129_133017-M.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p>We drove back to the dealership and talked about it. Sabrina liked this Jeep a lot, and we decided on some negotiating tactics. They were asking 10,955. I&rsquo;d point out the high mileage and lack of rear seat, and offer 8. Our highest was 9,500.</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-wkLtvhd/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-wkLtvhd/0/M/20141129_133043-M.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p>I sat down with the salesman and we did just that (when I mentioned the missing seat, the salesman gave me a look that let me know I had him over a barrel a little bit). We agreed on a final price, and they wouldn&rsquo;t be replacing the rear seat. Sabrina got back on the road while I signed the paperwork.</p>

<p>On the way back, I stopped by Mars Cheese Castle!</p>

<p><a href="http://agocs.smugmug.com/Other/Jeepquest/i-nzsX7jT/A" title="Photo & Video Sharing by SmugMug"><img src="http://agocs.smugmug.com/Other/Jeepquest/i-nzsX7jT/0/M/20141129155154-M.jpg" title="Photo & Video Sharing by SmugMug" alt="Photo & Video Sharing by SmugMug"></a></p>

<p>A bonus that came with the Jeep: a CD labeled &ldquo;Vegas 2012&rdquo;. I listened to it for a while, seemed to mostly be West Coast rap I didn&rsquo;t recognize. I switched to NPR.</p>

<p>Success!</p>

<p>Stuff to get/replace:</p>

<ul>
<li>Rear seat</li>
<li>Windshield wipers are looking gnarly</li>
<li>One of the rubber windshield hood rests (ordered)</li>
<li>Head unit with a less ugly one</li>
<li>Locking underseat storage drawer</li>
<li>Spare tire is looking a little old and cracked, despite never having been used. The other tires are worn, but not egregiously so. They are M+S rated Firestone ATs. I&rsquo;ll replace all the tires in probably six months&#8217; time.</li>
<li>Tow hooks</li>
<li>Grab handles</li>
<li>Side steps</li>
</ul>


<p>Stuff it could probably use:</p>

<ul>
<li>Oil change (Little darker than I&rsquo;d like)

<ul>
<li>Blackstone Labs analysis</li>
</ul>
</li>
<li>Coolant flush/fill (looked OK, do eventually)</li>
<li>Other fluids eventually</li>
</ul>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-11-29T22:48:18-05:00" pubdate data-updated="true">Nov 29<span>th</span>, 2014</time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/jeepquest/'>jeepquest</a>, <a class='category' href='/blog/categories/jeeps/'>jeeps,</a>

</div>


	
</div></article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2016

    Christopher Agocs

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'agocs';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
